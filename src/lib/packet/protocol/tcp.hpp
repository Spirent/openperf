#ifndef _LIB_PACKET_PROTOCOL_TCP_HPP_
#define _LIB_PACKET_PROTOCOL_TCP_HPP_

/**
 * tcp header for the packet header C++ Library
 *
 * This file is automatically generated by the library code generator.
 * Do not edit this file manually.
 **/

#include "packet/type/endian.hpp"
#include "packet/type/enum_flags.hpp"

namespace packet::protocol {

struct tcp
{
    static constexpr uint16_t protocol_length = 20;

    enum class flags_value
    {
        ns = 0x100,
        cwr = 0x80,
        ece = 0x40,
        urg = 0x20,
        ack = 0x10,
        psh = 0x8,
        rst = 0x4,
        syn = 0x2,
        fin = 0x1,
    };

    type::endian::number<uint16_t> source;
    type::endian::number<uint16_t> destination;
    type::endian::number<uint32_t> sequence;
    type::endian::number<uint32_t> ack;
    type::endian::field<2> data_offset_reserved_flags;
    type::endian::number<uint16_t> window;
    type::endian::field<2> checksum;
    type::endian::field<2> urgent_pointer;
};

/**
 * tcp get functions
 **/

uint16_t get_tcp_source(const tcp& header) noexcept;
uint16_t get_tcp_destination(const tcp& header) noexcept;
uint32_t get_tcp_sequence(const tcp& header) noexcept;
uint32_t get_tcp_ack(const tcp& header) noexcept;
uint16_t get_tcp_data_offset(const tcp& header) noexcept;
uint16_t get_tcp_reserved(const tcp& header) noexcept;
type::bit_flags<tcp::flags_value> get_tcp_flags(const tcp& header) noexcept;
uint16_t get_tcp_window(const tcp& header) noexcept;
uint16_t get_tcp_checksum(const tcp& header) noexcept;
uint16_t get_tcp_urgent_pointer(const tcp& header) noexcept;

/**
 * tcp set functions
 **/

void set_tcp_source(tcp& header, uint16_t value) noexcept;
void set_tcp_destination(tcp& header, uint16_t value) noexcept;
void set_tcp_sequence(tcp& header, uint32_t value) noexcept;
void set_tcp_ack(tcp& header, uint32_t value) noexcept;
void set_tcp_data_offset(tcp& header, uint16_t value) noexcept;
void set_tcp_reserved(tcp& header, uint16_t value) noexcept;
void set_tcp_flags(tcp& header, type::bit_flags<tcp::flags_value> value) noexcept;
void set_tcp_window(tcp& header, uint16_t value) noexcept;
void set_tcp_checksum(tcp& header, uint16_t value) noexcept;
void set_tcp_urgent_pointer(tcp& header, uint16_t value) noexcept;

}

declare_enum_flags(packet::protocol::tcp::flags_value);

#endif /* _LIB_PACKET_PROTOCOL_TCP_HPP_ */
